from flask import Flask
from sqlalchemy import create_engine
from sqlalchemy.orm import mapper, sessionmaker
import random
import json
engine = create_engine('postgresql+psycopg2://postgres:postgres@139.159.251.18:9999/geodatabase')
Session_class = sessionmaker(bind=engine)
app = Flask(__name__)

adcodelist = [30902,640425,650121,320413,451324,130205,310151,659009,130506,230804,230125,500105,654325,220113,430682,540330,520113,430224,141026,140428,350112,620981,610924,520628,511304,540121,440111,513330,640121,230129,210711,530521,510722,120111,450110,371622,540531,331002,130637,370215,430422,511402,522722,231182,130732,370782,451023,540322,210214,510802,130430,622925,210311,210181,621221,152523,640303,320105,451402,540237,513323,320902,410603,469002,510131,450103,500112,350981,370983,500104,140224,210114,431321,410883,140823,410481,360421,441225,230229,441223,220722,130481,532502,411603,433125,420323,140822,410927,522301,370687,532532,440513,210604,421122,130636,320324,610116,540329,350982,620402,441803,360602,341102,420504,320921,530621,430981,140123,420923,520425,522633,450406,632726,340602,451421,411628,540325,422825,530125,522728,411724,510108,430102,654321,411402,510824,130522,341204,430527,532925,510303,341502,350725,520281,141081,321081,130322,320104,632625,421303,350626,370303,410804,513223,533423,411003,140213,130703,210922,331126,420702,653225,140828,530324,441702,511323,350602,110116,653130,440825,340304,150522,420624,659003,131025,130821,220821,150404,820001,350825,511303,522636,220502,630104,230100,450481,411423,320205,130102,130229,320682,230304,653127,610527,210202,330111,530722,810018,110115,632621,371428,500237,621227,450125,130184,330205,621126,440704,500114,350722,431382,530127,440205,150921,371725,410702,450108,610482,150428,654002,370305,533301,610632,533323,350721,330104,340722,530821,220582,442000,451121,522325,140502,411681,511822,130209,520330,440281,130926,220524,510921,150702,420102,130927,520115,321112,430502,532623,370126,410506,611025,410725,610681,520625,361129,431127,140923,441323,530427,371621,110101,450302,420204,350803,140430,360681,210224,520603,410411,522628,371426,150521,370104,330481,420114,532823,512002,110108,610103,520323,360727,441882,441721,450881,530823,610429,610828,370911,341126,210905,371324,130731,360603,440307,422823,630122,469026,371323,320571,231025,652302,430203,210212,410108,371482,451223,620723,310107,230624,330681,420502,222402,653122,361030,513227,511024,150624,652902,150929,350681,450327,500119,440233,620721,150622,220381,230725,450922,810006,420704,430722,231002,211103,141127,500101,350802,341282,540524,421222,440511,810011,610881,522328,460203,441602,513232,460205,530902,513325,530622,350182,330225,440904,320925,532924,340111,130702,530927,150802,430703,310118,110109,231086,140827,360103,530423,370724,653125,130532,810008,430681,445122,632822,350128,370406,533325,340404,469030,640522,371321,431229,640521,341002,420113,230124,330782,451481,330106,620525,140212,230406,640181,150785,360112,150223,321084,622921,411122,410621,410611,431126,610602,420581,370921,130525,450703,420222,330103,330185,320303,210803,350423,131022,640502,371329,361024,361026,360123,130302,650107,450102,370685,140427,341825,522726,654003,513226,150424,610830,371082,211302,330212,632523,411722,510521,410822,511181,340121,411302,540231,120105,433126,370124,513301,530802,340303,410505,430903,230404,430104,230921,610124,150727,131123,420822,341702,652922,652301,310120,350724,445381,630106,500155,450124,222426,610581,341321,610826,451081,620503,410326,410803,131103,431103,320302,630224,441402,370203,610117,130726,140214,320706,410325,230524,654223,520521,430822,370402,310109,330921,511002,360821,150103,370827,632825,522635,230602,411503,210203,610328,411502,152224,130502,421381,410203,341622,469007,330402,230111,130321,231083,411627,532930,610430,220183,510705,522725,610122,650205,441203,411103,430105,540321,652924,500117,231283,340603,540327,130129,530103,469029,230822,511521,450224,419001,150625,429004,370785,410802,500243,451229,110107,320305,620924,210505,441284,431102,522626,222403,140981,230221,140429,430602,210381,520181,431202,533324,220202,211122,610725,360823,820007,130903,130423,361025,330503,230603,520111,141130,441302,360104,330127,131102,152501,211204,340202,540324,341721,370682,211104,420302,320508,220681,540622,370781,141029,360922,513327,210403,360111,141028,370704,630222,370105,540526,420625,330110,450803,440310,350503,620902,542522,110113,621027,361130,540103,430112,653023,320723,230127,441226,370282,410526,520329,451003,210522,530625,330922,621021,422827,350821,540124,220303,430407,411481,542523,371623,500111,411329,511124,360703,420881,411726,330226,510703,532325,150927,370285,540422,610831,211303,150203,231221,542525,130130,621125,440811,511025,610114,150207,320116,445222,610402,150823,632221,410922,371723,321282,140881,120116,532331,532625,220103,510682,500241,621122,421087,450311,211011,330825,210204,350212,610730,532326,510403,410223,230726,330112,451425,360881,150783,222401,621023,622927,341225,350702,441821,610524,610729,220211,410182,820002,210105,440402,520325,310115,230184,330305,361125,410402,530323,130627,150824,511702,469025,330604,230128,431302,431226,130682,611024,540102,440224,370283,450205,659010,231003,410105,130432,152527,632801,520381,540527,140703,140602,230623,441426,131082,330329,510110,420582,450105,431122,140928,430426,411522,371322,320102,331023,331081,632622,620523,231281,320722,623023,310113,230903,652801,513231,540530,310110,210504,130983,430626,460321,451323,610428,320211,653223,610825,140223,469001,530302,460204,230109,530381,370181,511325,370828,530724,410324,130104,361104,320585,500116,441322,330523,632222,140724,440308,430511,150926,340422,360322,540230,511113,445203,411602,510121,410928,422826,150826,431081,360729,360731,350205,140431,150726,512022,360113,820000,341181,445302,500238,341124,610724,320118,211282,450325,340104,450821,653221,510181,422801,341004,500109,653222,520221,652828,511504,522327,371625,350623,530112,632521,500229,640422,320404,360829,611021,330803,430405,411321,451122,350105,540122,620821,150603,620823,440229,430111,230904,511825,652929,330702,410204,350425,500151,330624,410423,360803,610502,411729,652323,430382,220104,350302,522632,540235,500230,341021,340522,540528,630105,330783,371325,513401,220122,532822,140726,610621,430481,350902,341523,654322,430921,340402,420981,610329,420322,320111,532622,350783,210682,510129,540302,410212,511921,530624,130181,370811,330424,370612,431021,210681,411728,421127,340523,653101,150221,430922,230883,513424,659001,500103,410202,510603,231005,341221,230422,540236,141027,130127,513429,511526,370784,410527,320830,410104,510504,421181,360723,410403,131024,210323,231225,130224,420281,320621,371603,350304,440881,231102,141024,130628,430103,360702,540426,410782,441825,431128,430503,340706,371523,411424,441502,410323,530126,420984,610118,411527,653001,420381,410721,150122,410381,610829,513230,131128,510184,130204,140825,110105,140411,140321,150430,511622,610802,411282,120106,211004,410622,411524,430523,530925,360830,320600,370304,140402,450421,421003,445103,230521,429006,370881,632301,511827,530111,652723,141022,140722,120112,330602,410184,620105,440608,510112,331003,620702,520424,410302,510304,430225,410225,810017,210112,440222,450202,140623,610426,540328,140725,360281,130126,230503,211404,370405,611026,630202,341222,533124,652822,522625,520624,350430,150524,360725,320923,610322,350823,510811,431281,120113,330822,469027,210521,231226,451082,532527,350181,530428,140425,652923,410328,341881,411525,410311,370404,420107,520627,652825,341522,430581,150721,430204,513326,350203,654225,350322,511421,522302,621222,350211,431025,540521,430223,341022,620881,430202,510727,654324,140930,371121,513428,350925,513233,410727,623021,130606,230230,621225,620826,530102,141021,371721,640104,150124,140924,610424,370113,451031,370681,621022,220402,632821,610503,451002,410327,650421,653227,130824,230204,230305,540232,371312,140821,230724,350213,230303,150502,522324,532301,230606,540104,430181,130981,371083,530128,150425,371728,810014,230112,522731,640205,220623,511524,532927,230421,410103,450329,140406,130629,231081,540525,530627,220323,130634,130706,440902,469021,532528,431028,540624,341226,130131,341504,451302,420202,231183,360825,211403,522629,451221,500233,230805,331022,420506,340826,350206,469005,320402,654221,370505,500240,411102,341723,530826,652925,522730,653224,210111,532627,431225,130431,659002,140322,211081,451226,532929,321204,210882,141031,610721,450722,341203,520623,360424,410821,650202,410704,152530,620104,533401,440106,341024,370826,321003,370523,540421,542521,330382,810010,540223,150822,510725,652722,510105,520322,511826,320114,540226,320684,130528,331121,440118,522623,371522,410823,520422,430408,321002,361123,411327,140581,420882,540228,230110,210881,150626,130708,659008,511723,330211,451022,540625,230502,320602,320214,510904,130581,611022,360728,231124,420902,440803,371722,371525,230622,210321,513332,500152,370923,441481,623001,540326,411723,340705,620802,511321,450403,610627,620423,610726,220203,350924,650204,320981,370614,230811,130608,350403,610112,320681,610827,140311,350627,330723,520123,640221,441781,632322,411024,360124,220184,650102,330203,440823,150423,411025,650104,445281,430281,451228,450332,620421,430923,511603,210726,610922,130529,620102,530581,370502,640324,450521,520201,370902,450804,530304,350921,632321,370202,652826,410185,450127,511525,370117,341202,510114,210303,360826,530424,441403,440507,371427,652901,610728,150302,130535,130227,450330,510115,130404,440104,130723,130530,450405,530322,210804,430821,610625,632623,610525,450423,120101,532504,350628,430121,511324,510981,360404,469023,654326,350123,440784,210603,511403,520382,469006,451102,360924,520527,210283,350102,340824,431026,320583,654226,450204,360429,421083,450303,220106,330421,141082,512021,220605,520523,140925,530524,621228,410811,140110,810012,420304,610202,522601,659006,540224,371425,152526,620622,360402,511126,371423,130526,130533,340604,610324,810016,430528,540523,360828,511527,632723,530828,653131,350603,540630,330483,210911,511824,450109,340825,231202,150422,610923,320113,532523,321281,650521,411330,610921,410303,232761,451322,320826,340103,540529,230751,230882,340828,654021,222405,370812,220102,431003,141126,130109,330802,320507,441704,360105,540621,130730,420682,210213,230881,411002,520524,341003,630203,654026,620200,210302,620921,511722,320904,230621,510726,532931,640106,230183,350581,654224,371002,360222,130930,232722,220302,330521,450602,130108,220802,520526,370302,130804,222404,450512,220382,532801,540323,532922,230781,130125,820006,540221,530924,510681,410523,360482,610631,421002,450312,430621,230403,532525,140105,420324,150204,360502,510525,230723,522323,130602,341824,211223,152201,220621,411626,341882,530723,441802,150104,211224,360926,411727,230224,632724,330824,513423,232721,511322,441423,230203,371521,130727,330727,421281,210703,230718,530115,371326,361022,623026,371402,440117,532926,370829,331004,532928,371422,410711,511112,441422,230722,150403,140211,321111,500242,540629,630102,620825,533123,130523,431125,330502,522622,370634,131122,360726,220400,131028,420117,130434,330302,620103,513328,433127,130828,370684,513437,130923,140830,441881,141030,411521,220283,230505,320106,370702,411422,654025,450603,430124,430524,410482,131081,210211,430302,350527,371122,231000,340181,130503,440311,350421,371626,652928,150627,150724,310114,411621,320311,330213,341122,451103,230605,445102,320707,510524,513337,350125,320509,350426,220282,441823,530114,220403,360824,532329,654027,350703,350521,621202,632324,130984,340221,411326,370602,421126,140222,440883,530181,130709,440303,140802,530425,511602,532923,510723,152202,429005,441581,511529,320411,340811,430424,420505,361126,450802,532601,632624,370830,370103,350305,410825,632823,230306,350303,420106,220602,420703,510104,211005,340803,361128,440305,230205,610703,141102,430721,411303,522723,330781,520402,230207,330881,350881,211002,620922,433122,130638,511133,410783,340802,451027,520324,810013,510113,421125,411324,350429,530629,220881,610481,210624,360202,340322,440606,310104,350582,420683,370321,230103,340281,422802,441623,210123,533422,431123,420325,231085,410122,513201,530602,513221,513426,411425,511425,421124,130928,411322,540522,150125,652827,370703,370306,320213,360313,131026,350103,522727,610425,530900,510812,621102,310101,360822,441624,130632,152921,513425,130827,140926,220521,652328,130425,370705,370102,410726,220781,632224,130705,610522,370611,530721,210124,652824,130623,532327,630225,410304,140121,341182,620111,621002,530129,340711,410183,211481,420503,150206,610304,350926,140403,532530,150525,430603,341822,220702,513222,330108,230803,231223,510781,320685,110117,430623,211281,140521,610523,350781,451202,130183,441900,440523,640424,430211,513335,150105,211402,120117,130403,623024,411325,360423,445321,130534,530824,340302,230523,420804,520122,620321,360730,150925,340421,320115,654022,620602,360982,371503,230208,130107,640423,130521,371103,620621,430725,350481,141125,610331,610115,140728,140423,540402,331083,632525,511123,630103,371602,220105,530825,220221,130582,340222,620725,530827,650522,140927,632857,360983,510923,621024,211221,130303,621223,640202,340207,430522,330102,370322,360732,230104,330326,440105,361002,320703,430381,450921,532901,330281,361124,450305,211422,321182,230225,370831,513228,350505,620123,140622,330482,520621,530113,210115,371526,230231,530628,341602,510107,411702,331124,340321,130427,130203,510116,360430,220882,430802,451422,130684,451029,231222,610113,210904,513329,220503,511083,360102,411224,130306,130825,361127,331127,131127,510903,210921,420115,321181,653226,430611,130111,140181,440113,222424,230321,441303,360981,513435,410305,520327,220281,430412,530702,513333,430724,532322,513338,630123,410221,610423,451024,420802,622922,140122,230506,321323,520102,653201,130722,440304,440703,370115,310116,451227,140721,610629,231181,420606,654201,320381,530921,450321,130433,654323,210502,140405,361028,513334,610723,320382,622924,340323,411426,371581,360802,431381,410882,610824,220622,410422,230202,152221,140404,530829,632626,411625,420602,150928,510604,440282,310117,411203,110102,522701,141025,421223,150421,410421,330105,370683,410329,152923,410205,150523,654024,360902,411403,350824,431223,410102,433123,420583,450981,450924,140221,440112,430406,440114,131003,331123,130929,451222,420684,421224,500106,220723,513225,210281,500235,610528,130626,500102,540222,510502,150304,610630,652701,210304,210104,530923,542527,450903,500231,350629,131023,520121,371003,511423,120102,420527,620623,370725,450225,141034,320813,513434,540202,150123,610330,522729,652823,610204,321023,130110,211322,130202,441625,610111,140107,120119,320282,361023,450107,431230,410404,610422,411121,370212,130524,653022,321183,360483,421202,440982,530681,320117,440103,110118,350427,440605,210902,511621,350428,532624,220581,450326,652927,421023,441622,320623,659005,650203,532932,320281,140621,130424,410728,321283,511802,520626,430726,371524,360734,420303,441621,420116,440515,445202,440514,430423,610822,513422,510402,370832,530926,420607,140522,150784,131182,230381,320612,220182,420111,652325,451030,150725,230281,360921,500153,510823,420105,451321,230227,230302,610303,150205,130132,440309,130527,330381,652327,150981,653123,360426,360923,510704,220112,420203,450126,330327,511725,430212,430521,610222,411725,210402,510185,511781,411082,540234,211321,511132,511111,230717,650105,220204,530325,441826,360827,513322,460400,140921,140932,431322,361021,421123,140226,140824,341524,340882,230407,430525,140826,230712,513433,511681,610927,130881,654023,141181,140525,532524,520112,431121,150924,430624,511922,350502,610431,340881,532328,350923,152522,370281,211021,350526,520602,370481,533102,440607,371403,640402,371328,210903,410724,210602,350622,420922,433130,522624,361100,341525,130633,653024,430482,610404,150121,341324,330282,632323,210727,422822,211202,440404,520403,371502,610628,330182,430723,320412,130802,370613,451225,410222,120118,330784,141033,130681,211381,140681,210782,131125,610722,140829,130725,421102,650502,623025,620982,341103,321202,610626,370686,330303,450702,511724,140929,360203,130407,654028,130724,341823,120103,431022,140723,220523,500113,411221,421022,340504,360781,522732,450502,341125,430304,441424,440204,331102,610104,420982,430702,513431,410581,360783,513430,410781,360323,620923,510623,450328,632524,500107,371726,350723,371202,230102,440232,540602,330411,441523,440604,430582,652702,231123,411623,340124,540123,130505,230123,610326,210781,530623,341722,450721,654301,513324,140702,410425,140202,511302,510822,150782,141124,152222,152223,530403,532626,621226,451028,510411,370112,429021,653129,433101,330903,440804,445224,532529,650103,460106,659007,150202,370522,620422,533122,431124,431027,411281,431023,211003,610403,450923,469022,510626,220822,532531,371702,522634,371302,320321,410306,130225,370503,320582,450222,230113,371327,620302,350424,520502,220721,210102,610582,130728,610727,445303,532501,360724,361102,340506,361181,540628,510311,320724,500120,361027,430182,310106,611002,230800,320322,511381,460108,540225,350122,320802,360321,460105,230382,511823,410926,510683,370211,511502,220322,510321,520203,350624,370116,230307,410703,141123,130531,540227,510422,431222,500236,140215,421221,130609,150526,610928,632725,350104,320506,340521,130408,330726,430781,321102,360521,350525,433124,222406,130826,420528,440981,451423,630121,632701,320803,430902,522627,410106,341023,621123,340406,460107,370800,540423,152531,510106,610702,321203,350524,140729,120104,321311,451026,210811,360704,542524,530922,110119,650422,411624,341802,530326,532324,140203,420921,500108,330324,620724,330122,513432,530523,653121,370883,360722,130105,120115,640323,610302,130128,441224,130208,520525,131121,140524,140781,320804,340208,610926,350583,110111,440785,371481,130630,520304,540623,0,131002,411381,431224,230604,130924,650106,530481,110112,140225,370213,150222,540229,451381,150902,620121,621121,620722,513436,540627,321302,530422,150581,340223,522631,610323,440115,361103,650109,232701,341302,350121,130284,510302,140108,511503,141122,410902,411323,540233,500115,130123,421121,371681,542526,231004,331125,431221,652926,330383,330683,450323,410503,440783,540424,420205,522630,320831,140922,440983,510183,513331,370323,320312,131126,230108,361003,150722,150102,520303,370786,420104,410181,341323,350625,621026,130803,621224,320505,421182,330603,320812,130822,511703,360121,340503,532500,510522,350504,210411,110106,210702,340225,220284,330206,211382,150825,621124,411328,150723,469024,441521,341621,360481,623022,610803,520622,410923,341623,440781,430421,140882,520302,130635,431129,130324,140931,450503,331181,150429,441324,330703,130624,340621,513224,513427,371311,130207,320903,130982,210423,371724,371703,371102,650402,411528,230719,654004,130426,451224,620521,340403,130435,211102,150426,440306,321322,511903,520522,130402,530502,310112,430529,511803,530626,654202,150402,152922,152524,451203,331082,510322,150922,211421,411202,632803,511923,445322,530822,450223,350922,610526,150923,131124,211324,360735,510922,341821,230405,469028,411721,130683,510503,610929,130631,620822,441202,360925,340203,421024,420525,210802,350402,511528,130902,511424,140106,500156,450902,532503,210103,460202,150621,341503,411104,320481,220421,411523,610203,510421,230402,152525,361121,230826,431024,510182,422828,640381,411081,640105,530402,810005,370214,411622,620122,210106,130925,360733,653126,530124,232718,441427,130304,450123,340311,150821,421321,450206,450304,610622,440203,511623,511011,430811,533103,513336,141023,510821,410502,130283,370125,410602,220422,510124,210422,150781,441204,130921,360425,440400,120110,152529,431228,141032,632522,420626,350782,431002,130281,331024,450681,141121,370403,540502,130922,370982,652324,440882,450621,230223,530303,640302,370114,320922,370783,420112,340822,653128,420600,451424,511523,360428,620524,340122,152528,141129,430321,231224,320206,141002,510132,450422,520326,511129,460300,450381,500110,321012,330109,321324,532628,140109,632802,360403,440802,340827,610902,350124,231282,610327,440403,620403,210113,371424,520328,500154,450324,210404,230206,640122,540626,320581,500118,140603,410522,421081,410322,510117,540425,632722,340102,510180,622926,150703,431227,622923,620522,150623,610102,150602,320611,310105,140902,330522,140426,130607,140303,110114,520103,440512,141128,659004,140727,141182,150303,540127,230126,231084,140302,611023,152502,652829,632223,620502,622901,230828,450226,610603,420526,522702,653124,360302,623027,120114,420529,440705,411421,610925,440300,530426,520423,411526,420103,522326,330328,230522,511102,210421,451123,630223,350111,810009,510118,340123,340405,532323,331122,320924,341322,210503,330304,230902,511902,130133,450203,130121,621025,130406]
citylist = ['保山市','吉林市','苏州市','雅安市','本溪市','安庆市','亳州市','潍坊市','黔东南苗族侗族自治州','大连市','绍兴市','盐城市','台州市','日照市','长治市','十堰市','咸宁市','芜湖市','宜春市','三亚市','肇庆市','海南藏族自治州','广安市','晋城市','呼和浩特市','西双版纳傣族自治州','泰州市','龙岩市','西安市','合肥市','眉山市','邢台市','张家界市','拉萨市','泉州市','武汉市','红河哈尼族彝族自治州','陇南市','北海市','马鞍山市','烟台市','上海市','揭阳市','黔西南布依族苗族自治州','柳州市','铜陵市','绵阳市','咸阳市','果洛藏族自治州','池州市','梅州市','厦门市','鄂尔多斯市','商洛市','商丘市','阳江市','延安市','宜昌市','沈阳市','蚌埠市','长沙市','武威市','荆州市','信阳市','防城港市','海东市','平顶山市','临夏回族自治州','安阳市','宿迁市','江门市','汕头市','海北藏族自治州','保定市','佳木斯市','衡阳市','镇江市','六安市','吉安市','玉溪市','徐州市','邵阳市','凉山彝族自治州','济宁市','大同市','巴中市','乌兰察布市','甘南藏族自治州','南充市','成都市','景德镇市','达州市','毕节市','宜宾市','长春市','南平市','重庆市','淮南市','朝阳市','黄冈市','大庆市','漯河市','焦作市','桂林市','中山市','惠州市','佛山市','德宏傣族景颇族自治州','吕梁市','宝鸡市','黄山市','运城市','松原市','通化市','吴忠市','晋中市','临沂市','扬州市','连云港市','菏泽市','巴彦淖尔市','铜川市','淮北市','潮州市','益阳市','唐山市','常德市','濮阳市','鹰潭市','鞍山市','青岛市','贵阳市','丹东市','东营市','滁州市','葫芦岛市','珠海市','宿州市','白银市','遵义市','阜新市','泸州市','泰安市','曲靖市','湛江市','聊城市','云浮市','乌海市','上饶市','渭南市','乌鲁木齐市','鹤壁市','营口市','开封市','韶关市','玉树藏族自治州','洛阳市','延边朝鲜族自治州','呼伦贝尔市','淮安市','嘉兴市','昌都市','福州市','南阳市','汕尾市','株洲市','钦州市','德州市','安顺市','临汾市','周口市','定西市','文山壮族苗族自治州','新乡市','大理白族自治州','六盘水市','淄博市','深圳市','岳阳市','海口市','通辽市','抚顺市','银川市','兰州市','黔南布依族苗族自治州','山南市','河源市','宁德市','赣州市','贺州市','包头市','平凉市','太原市','北京市','邯郸市','许昌市','张家口市','攀枝花市','铁岭市','黄南藏族自治州','绥化市','杭州市','济南市','郴州市','自贡市','乐山市','威海市','齐齐哈尔市','莆田市','温州市','盘锦市','西宁市','廊坊市','郑州市','赤峰市','南昌市','德阳市','滨州市','丽水市','抚州市','普洱市','梧州市','林芝市','昌吉回族自治州','丽江市','玉林市','鹤岗市','承德市','固原市','枣庄市','吐鲁番市','昆明市','宣城市','金华市','天津市','无锡市','昭通市','石嘴山市','儋州市','孝感市','三门峡市','茂名市','萍乡市','湘潭市','锦州市','怒江傈僳族自治州','铜仁市','南通市','永州市','宁波市','驻马店市','嘉峪关市','恩施土家族苗族自治州','榆林市','白城市','舟山市','辽阳市','汉中市','怀化市','衢州市','三明市','襄阳市','牡丹江市','临沧市','九江市','中卫市','阳泉市','忻州市','南宁市','楚雄彝族自治州','鄂州市','百色市','崇左市','石家庄市','南京市','湘西土家族苗族自治州','天水市','秦皇岛市','庆阳市','常州市','黄石市','阜阳市','湖州市','金昌市','哈尔滨市','娄底市','沧州市','朔州市','安康市','清远市']
cityidlist = [116,184,87,273,51,272,70,190,278,169,176,92,180,236,263,22,271,156,197,135,227,282,173,149,73,269,261,103,280,42,189,161,239,117,121,88,188,125,40,257,113,240,43,120,196,291,15,210,226,48,187,57,81,19,61,160,244,242,251,204,104,266,5,171,91,283,179,54,29,4,181,96,201,10,35,105,6,107,233,86,220,89,93,219,252,241,175,31,285,50,253,14,231,66,109,13,155,133,195,2,199,75,246,128,243,166,142,152,230,7,222,38,193,164,254,78,159,217,186,250,47,20,177,182,1,76,106,18,110,178,145,27,129,143,203,58,228,8,71,229,68,267,52,80,146,162,258,132,84,170,192,276,101,237,69,262,115,114,60,97,238,108,112,59,268,289,65,127,124,98,200,44,11,235,82,119,286,153,147,279,214,202,9,79,26,85,72,281,95,77,232,259,172,30,288,21,131,3,17,198,212,37,28,249,255,165,56,151,209,74,225,34,138,245,205,83,67,63,90,216,174,45,213,134,274,144,39,163,168,223,36,287,221,102,167,158,277,290,118,265,284,111,16,207,62,123,126,194,99,41,46,206,224,157,53,32,275,247,260,100,183,136,150,140,139,12,137,248,208,24,191,25,94,141,122,154,218,49,234,211,256,33,185,64,264,215,55,148,130,270,23]

def getadcode():
    rd = random.randint(0, len(adcodelist))
    return adcodelist[rd]

def getcity():
    rd = random.randint(0, len(citylist))
    return citylist[rd]

def getcityid():
    rd = random.randint(0, len(cityidlist))
    return cityidlist[rd]



@app.route('/')
def hello_world():
    session = Session_class()
    result = session.execute("select count(*) as cnt  from t_city").fetchone()
    session.close()
    return 'Hello World!' + str(result[0])

@app.route('/getpoi')
def getpoi():
    session = Session_class()
    result = session.execute("select id,adcode,address from t_map_poi where adcode =" + str(getadcode()) )
    _data=[]
    for row in result:
        _data.append({"id":row['id'],"adcode":row['adcode'],"address":row['address']})
    session.close()
    return json.dumps(_data)

@app.route('/getgrid')
def getgrid():
    session = Session_class()
    sql = "select id,city,latitude,longitude,resident_heatvalue from t_map_grid_stat_heat_450 where resident_heatvalue>1000.0 and  city ='" + str(getcity())+"'"
    print(sql)
    result = session.execute(sql)
    _data=[]
    for row in result:
        _data.append({"id":row['id'],"city":row['city'],"latitude":row['latitude'],"longitude":row['longitude'],"resident_heatvalue":str(row['resident_heatvalue'])})
    session.close()
    return json.dumps(_data)

@app.route('/getgridbycityid')
def getgridbycityid():
    session = Session_class()
    sql = "select id,city,latitude,longitude,resident_heatvalue from t_map_grid_stat_heat_450_v1 where resident_heatvalue>1000.0 and  cityid =" + str(getcityid())
    print(sql)
    result = session.execute(sql)
    _data=[]
    for row in result:
        _data.append({"id":row['id'],"city":row['city'],"latitude":row['latitude'],"longitude":row['longitude'],"resident_heatvalue":str(row['resident_heatvalue'])})
    session.close()
    return json.dumps(_data)


if __name__ == '__main__':
    app.run()
